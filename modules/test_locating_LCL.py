import numpy as np
import matplotlib.pyplot as plt
from utils.find_lcl import find_intersection

R_h_373 =  np.array([1.01161189, 1.01211681, 1.01164886, 1.01207052, 1.01186224, 1.01194457,
 1.01199157, 1.01174014, 1.01205189, 1.01147208, 1.01205821, 1.01167681,
 1.01198409, 1.01186087, 1.01183072, 1.0119613,  1.01159929, 1.01200683,
 1.01145031, 1.01198489, 1.01168947, 1.01188292, 1.01184418, 1.01170211,
 1.01191569, 1.01144364, 1.01194625, 1.01147661, 1.01189599, 1.01168593,
 1.0117661,  1.01181124, 1.01155778, 1.01186736, 0.62894775, 1.06570944,
 1.05304566, 1.05820789, 1.05410329, 1.05028692, 1.05233647, 1.04240681,
 1.04892311, 1.03727781, 1.04454823, 1.0387516,  1.0396754,  1.03820159,
 1.03465282, 1.03634579, 1.02971227, 1.03379488, 1.02818501, 1.03079131,
 1.02813146, 1.02758648, 1.02713792, 1.0243537,  1.02557106, 1.0212348,
 1.02369557, 1.02095525, 1.02163014, 1.02039465, 1.01949934, 1.01940149,
 1.01738972, 1.01817997, 1.01580798, 1.01682383, 1.0154562,  1.01539915,
 1.0148028,  1.01396864, 1.01395915, 1.01258032, 1.01306146, 1.01186831,
 1.01217598, 1.0115964,  1.01157596, 1.01175052, 1.01197786, 1.01326513,
 1.01412623, 1.01567561, 1.01571978, 1.01495361, 1.0132539,  1.0113942,
 1.00968392, 1.00822152, 0.9959972,  1.0059642,  1.00536174, 1.00482788,
 1.00441417, 1.00405916, 1.00376747, 0.92778036])

p_vol_373 =  np.array([5.26210203e-61, 1.25099510e-60, 2.97127988e-60, 7.06325902e-60,
 1.67805295e-59, 3.98770026e-59, 9.47618784e-59, 2.25116918e-58,
 5.35091455e-58, 1.27075670e-57, 3.02126734e-57, 7.17645052e-57,
 1.70575832e-56, 4.05274950e-56, 9.62971506e-56, 2.28852406e-55,
 5.43597377e-55, 1.29219270e-54, 3.06878431e-54, 7.29567652e-54,
 1.73307541e-53, 4.11880021e-53, 9.78663620e-53, 2.32510795e-52,
 5.52604893e-52, 1.31245101e-51, 3.12005102e-51, 7.41022844e-51,
 1.76146786e-50, 4.18462431e-50, 9.94384073e-50, 2.36290234e-49,
 5.61306835e-49, 1.33413527e-48, 3.16820696e-48, 1.26828583e-46,
 1.00335142e-44, 6.99888491e-43, 4.21599541e-41, 2.22266554e-39,
 1.03565162e-37, 4.21008841e-36, 1.54059519e-34, 4.92888085e-33,
 1.43393293e-31, 3.69273047e-30, 8.60901934e-29, 1.80754668e-27,
 3.42991427e-26, 5.94366766e-25, 9.31133222e-24, 1.34734856e-22,
 1.77082956e-21, 2.15692460e-20, 2.40988398e-19, 2.49392602e-18,
 2.39219096e-17, 2.12686301e-16, 1.76793217e-15, 1.36431505e-14,
 9.91505353e-14, 6.72175961e-13, 4.29556834e-12, 2.57961650e-11,
 1.46172860e-10, 7.83438584e-10, 3.96810270e-09, 1.91159742e-08,
 8.72274272e-08, 3.80065914e-07, 1.57496070e-06, 6.23904680e-06,
 2.36205450e-05, 8.56097489e-05, 2.97786463e-04, 9.93248008e-04,
 3.19097228e-03, 9.85169880e-03, 2.93494095e-02, 8.42308098e-02,
 2.33213404e-01, 6.22074993e-01, 1.59349947e+00, 3.90094049e+00,
 9.02879430e+00, 1.95577166e+01, 3.91884837e+01, 7.24245934e+01,
 1.23938084e+02, 1.98387349e+02, 3.00527822e+02, 4.35508250e+02,
 6.09351619e+02, 8.31163377e+02, 1.10902019e+03, 1.45296197e+03,
 1.87481249e+03, 2.38825622e+03, 3.00928207e+03, 3.75840914e+03])

p_sat_373 =  np.array([5.2017004774276473e-61, 1.236018495871677e-60, 2.937066390512068e-60, 6.979018621295138e-60, 
              1.6583808288478054e-59, 3.940631111456914e-59, 9.363900005254952e-59, 2.2250468126073366e-58, 
              5.287193896761068e-58, 1.2563438213225443e-57, 2.9852703384312556e-57, 7.093619663661819e-57, 
              1.6855584393054815e-56, 4.005243822608849e-56, 9.517120667732358e-56, 2.2614738901228008e-55, 
              5.373643327791582e-55, 1.2768616379064488e-54, 3.0340435615358054e-54, 7.20927415969965e-54, 
              1.7130507629478978e-53, 4.0704316045659114e-53, 9.67207836710468e-53, 2.2982139974160446e-52, 
              5.460977612673385e-52, 1.297601715029498e-51, 3.083218127397421e-51, 7.326149096218968e-51, 
              1.7407598077831955e-50, 4.1362879312367326e-50, 9.82820112621082e-50, 2.3353193364418164e-49, 
              5.548934958402446e-49, 1.3184882896508249e-48, 5.0373134263417506e-48, 1.1900859489299395e-46, 
              9.528090425871255e-45, 6.613903516898051e-43, 3.9996036862627607e-41, 2.1162460492801432e-39, 
              9.841449384228205e-38, 4.038815160020623e-36, 1.468739874912179e-34, 4.751746169794245e-33, 
              1.3727781052284496e-31, 3.554969694421044e-30, 8.280487667176994e-29, 1.7410363259336104e-27, 
              3.3150388416384955e-26, 5.735216689853975e-25, 9.042654443020733e-24, 1.3033035717762626e-22, 
              1.722286880893595e-21, 2.0924939716576814e-20, 2.3439453822388184e-19, 2.426974346501444e-18, 
              2.3289871081656538e-17, 2.0762974966566599e-16, 1.7238514532465181e-15, 1.3359464924381112e-14, 
              9.685548930655597e-14, 6.583794524830173e-13, 4.204621766252779e-12, 2.528057648889734e-11, 
              1.4337710070607654e-10, 7.68527994371641e-10, 3.900277960539093e-09, 1.8774651612464757e-08, 
              8.586999637562027e-08, 3.737775459975961e-07, 1.5509883153950089e-06, 6.1444278456623265e-06, 
              2.3275995212969882e-05, 8.443037181397662e-05, 0.0002936868432624585, 0.0009809078723277103, 
              0.0031498308812288774, 0.009736147179046336, 0.02899635040873961, 0.08326523318825595, 
              0.23054462835915576, 0.6148501845077686, 1.5746386647822912, 3.8498714555069053, 
              8.903028114514088, 19.255869164471648, 38.58198341980832, 71.35754060088568, 
              122.31690816796367, 196.15234955845926, 297.64544862717247, 431.9569064160669, 
              611.8005344143775, 826.2355459409189, 1103.1056304712831, 1445.9809421017014, 
              1866.5731277451287, 2378.601099487796, 2997.987255208945, 4050.9686513809693])

p_373 =  np.array([1.05297098e+00, 1.18200916e+00, 1.32686056e+00, 1.48946302e+00,
 1.67199190e+00, 1.87688909e+00, 2.10689578e+00, 2.36508904e+00,
 2.65492304e+00, 2.98027527e+00, 3.34549836e+00, 3.75547836e+00,
 4.21570007e+00, 4.73232047e+00, 5.31225103e+00, 5.96325021e+00,
 6.69402722e+00, 7.51435859e+00, 8.43521892e+00, 9.46892769e+00,
 1.06293141e+01, 1.19319022e+01, 1.33941182e+01, 1.50355240e+01,
 1.68780788e+01, 1.89464328e+01, 2.12682568e+01, 2.38746128e+01,
 2.68003693e+01, 3.00846679e+01, 3.37714466e+01, 3.79100280e+01,
 4.25557793e+01, 4.77708523e+01, 5.36250156e+01, 6.01965878e+01,
 6.75734848e+01, 7.58543966e+01, 8.51501074e+01, 9.55849775e+01,
 1.07298607e+02, 1.20447704e+02, 1.35208181e+02, 1.51777505e+02,
 1.70377348e+02, 1.91256540e+02, 2.14694410e+02, 2.41004515e+02,
 2.70538839e+02, 3.03692498e+02, 3.40909030e+02, 3.82686329e+02,
 4.29583300e+02, 4.82227343e+02, 5.41322743e+02, 6.07660093e+02,
 6.82126871e+02, 7.65719312e+02, 8.59555735e+02, 9.64891509e+02,
 1.08313584e+03, 1.21587063e+03, 1.36487164e+03, 1.53213225e+03,
 1.71989009e+03, 1.93065706e+03, 2.16725283e+03, 2.43284265e+03,
 2.73097965e+03, 3.06565236e+03, 3.44133814e+03, 3.86306299e+03,
 4.33646886e+03, 4.86788908e+03, 5.46443314e+03, 6.13408173e+03,
 6.88579359e+03, 7.72962531e+03, 8.67686588e+03, 9.74018771e+03,
 1.09338162e+04, 1.22737200e+04, 1.37778246e+04, 1.54662525e+04,
 1.73615916e+04, 1.94891985e+04, 2.18775367e+04, 2.45585580e+04,
 2.75681298e+04, 3.09465149e+04, 3.47389102e+04, 3.89960512e+04,
 4.37748911e+04, 4.91393623e+04, 5.51612321e+04, 6.19210626e+04,
 6.95092884e+04, 7.80274267e+04, 8.75894354e+04, 9.83232372e+04])

tmp_373 =  np.array([ 36.65527867,  36.84539971,  37.03750796,  37.23162572,  37.42779388,
  37.62603569,  37.8263938,   38.02889248,  38.23357296,  38.44046708,
  38.64960798,  38.86104219,  39.07479768,  39.29092305,  39.50944753,
  39.7304219,   39.95387673,  40.17985797,  40.40841188,  40.63957572,
  40.87340522,  41.10993573,  41.34922556,  41.59131176,  41.8362554,
  42.08409531,  42.33488366,  42.58868482,  42.84554168,  43.10552173,
  43.36866999,  43.63505729,  43.90473091,  44.17776094,  44.60738301,
  45.65486344,  47.19068692,  48.77814999,  50.41904886,  52.11511846,
  53.8682821,   55.68038911,  57.55345105,  59.48953478,  61.49071765,
  63.55926069,  65.69735438,  67.90741974,  70.19179167,  72.55306249,
  74.99372104,  77.51644645,  80.12408484,  82.81940184,  85.60544497,
  88.48516221,  91.46181674,  94.5385509,   97.71881814, 101.00604917,
 104.40381172, 107.91594195, 111.54616188, 115.29857912, 119.17716111,
 123.1863061,  127.33024311, 131.61357222, 136.0410199,  140.61733652,
 145.34769223, 150.23709495, 155.29107707, 160.51496593, 165.91465482,
 171.49573836, 177.26408662, 183.22555179, 189.38484803, 195.74514559,
 202.30458516, 209.05213526, 215.95743358, 222.9588029,  229.94964567,
 236.781196,   243.2928024,  249.36044041, 254.93251302, 260.02443236,
 264.69263628, 269.00569668, 273.16810204, 277.38665828, 281.56898098,
 285.60180541, 289.51336553, 293.32763296, 297.06410884, 302.06890209])

# ------------------------------------------------------------------------

R_h_500 =  np.array([1.01161214e+00, 1.01211712e+00, 1.01164913e+00, 1.01207083e+00,
 1.01186254e+00, 1.01194487e+00, 1.01199188e+00, 1.01174043e+00,
 1.01205221e+00, 1.01147234e+00, 1.01205854e+00, 1.01167711e+00,
 1.01198442e+00, 1.01186119e+00, 8.03343092e-01, 1.07646828e+00,
 1.05854672e+00, 1.07125001e+00, 1.05065543e+00, 1.06426509e+00,
 1.05456825e+00, 1.05640371e+00, 1.05457122e+00, 1.04829523e+00,
 1.05209303e+00, 1.04034539e+00, 1.04825676e+00, 1.03854246e+00,
 1.04358219e+00, 1.03929285e+00, 1.03853248e+00, 1.03823956e+00,
 1.03341975e+00, 1.03607654e+00, 1.02848335e+00, 1.03329516e+00,
 1.02866445e+00, 1.03014585e+00, 1.02826402e+00, 1.02685664e+00,
 1.02702747e+00, 1.02358364e+00, 1.02532086e+00, 1.02123500e+00,
 1.02333387e+00, 1.02109679e+00, 1.02119920e+00, 1.02036849e+00,
 1.01903020e+00, 1.01925805e+00, 1.01690496e+00, 1.01797632e+00,
 1.01592517e+00, 1.01656752e+00, 1.01546025e+00, 1.01511244e+00,
 1.01472909e+00, 1.01367448e+00, 1.01386613e+00, 1.01235030e+00,
 1.01305557e+00, 1.01222956e+00, 1.01276438e+00, 1.01313376e+00,
 1.01434357e+00, 1.01634486e+00, 1.01785696e+00, 1.01861333e+00,
 1.01717550e+00, 1.01506373e+00, 1.01254346e+00, 1.01043412e+00,
 1.00871144e+00, 1.00738864e+00, 1.00638534e+00, 1.00559147e+00,
 1.00501666e+00, 1.00452525e+00, 1.00416144e+00, 1.00384468e+00,
 1.00359554e+00, 7.96123043e-01, 4.93896545e-01, 2.97852793e-01,
 1.83274951e-01, 1.14989857e-01, 7.35171831e-02, 4.78668729e-02,
 3.17200174e-02, 2.13818256e-02, 1.46528044e-02, 1.02032358e-02,
 7.21552888e-03, 5.17955629e-03, 3.77228882e-03, 2.78609140e-03,
 2.08580438e-03, 1.58213149e-03, 1.21541512e-03, 9.45224319e-04])

p_vol_500 =  np.array([5.41664591e-61, 1.28778971e-60, 3.05880109e-60, 7.27162373e-60,
 1.72762990e-59, 4.10569409e-59, 9.75701564e-59, 2.31798678e-58,
 5.50998713e-58, 1.30859400e-57, 3.11137193e-57, 7.39082517e-57,
 1.75679662e-56, 4.17421436e-56, 9.91881280e-56, 3.32030214e-54,
 4.61526706e-52, 5.61956622e-50, 5.67422733e-48, 5.08863337e-46,
 3.85833886e-44, 2.56799067e-42, 1.48594753e-40, 7.50176552e-39,
 3.36518897e-37, 1.31422650e-35, 4.63999304e-34, 1.43480307e-32,
 4.02308106e-31, 1.00326043e-29, 2.26046817e-28, 4.60436767e-27,
 8.46479223e-26, 1.42558790e-24, 2.16859650e-23, 3.05485690e-22,
 3.91313669e-21, 4.63991492e-20, 5.06017013e-19, 5.10747448e-18,
 4.78894469e-17, 4.15999523e-16, 3.38483170e-15, 2.55805705e-14,
 1.82076394e-13, 1.21076836e-12, 7.58648443e-12, 4.47407416e-11,
 2.48910717e-10, 1.31157021e-09, 6.53039452e-09, 3.09612022e-08,
 1.39121418e-07, 5.96821351e-07, 2.43772468e-06, 9.51771902e-06,
 3.55480463e-05, 1.27102699e-04, 4.36481921e-04, 1.43712179e-03,
 4.55845638e-03, 1.38837843e-02, 4.06874228e-02, 1.14228004e-01,
 3.05480858e-01, 7.69230050e-01, 1.79325007e+00, 3.81473295e+00,
 7.35244315e+00, 1.29293918e+01, 2.10259737e+01, 3.21275016e+01,
 4.67569129e+01, 6.55192183e+01, 8.91265924e+01, 1.18411883e+02,
 1.54366043e+02, 1.98132593e+02, 2.51066634e+02, 3.14726968e+02,
 3.90940781e+02, 4.72066153e+02, 5.29916332e+02, 5.94855864e+02,
 6.67753525e+02, 7.49584558e+02, 8.41443720e+02, 9.44559925e+02,
 1.06031269e+03, 1.19025057e+03, 1.33611193e+03, 1.49984812e+03,
 1.68364966e+03, 1.88997547e+03, 2.12158585e+03, 2.38157933e+03,
 2.67343417e+03, 3.00105487e+03, 3.36882444e+03, 3.78166297e+03])

p_sat_500 =  np.array([5.354469069009003e-61, 1.2723722204227102e-60, 3.023579029844892e-60, 7.184896057906703e-60, 
              1.7073760949169607e-59, 4.057230976115767e-59, 9.641397155137765e-59, 2.2910884126564563e-58, 
              5.4443704121489225e-58, 1.2937516352994565e-57, 3.0743003503134416e-57, 7.305517871376214e-57, 
              1.7359917649668877e-56, 4.125283575915714e-56, 1.2346919890407218e-55, 3.0844402867428315e-54, 
              4.360003182732953e-52, 5.245802743865346e-50, 5.4006548144069084e-48, 4.7813588967061575e-46, 
              3.658690541507437e-44, 2.4308800148677784e-42, 1.4090537496056284e-40, 7.156157235943844e-39, 
              3.1985659696963087e-37, 1.263259790372655e-35, 4.4263897918360575e-34, 1.381554567687119e-32, 
              3.8550687106940036e-31, 9.653298650772312e-30, 2.176598430150795e-28, 4.4347835138805884e-27, 
              8.191049431322684e-26, 1.3759484380109048e-24, 2.1085382677892724e-23, 2.9564223336658267e-22, 
              3.8040944101380854e-21, 4.504133961705493e-20, 4.921080596850224e-19, 4.9738924211775445e-18, 
              4.662917828474681e-17, 4.0641478455072666e-16, 3.3012414256081267e-15, 2.5048662201000745e-14, 
              1.7792472261976988e-13, 1.1857527814178525e-12, 7.428995628400654e-12, 4.3847631699214504e-11, 
              2.442623555597496e-10, 1.2867891556086353e-09, 6.4218336767282995e-09, 3.0414462047265595e-08, 
              1.3694061559129082e-07, 5.870946514710096e-07, 2.4006106345836334e-06, 9.376024412724963e-06, 
              3.503205585667859e-05, 0.00012538808198831876, 0.000430512380532887, 0.0014195894338560272, 
              0.004499710092642101, 0.013716043187797873, 0.0401746187124824, 0.11274720872675863, 
              0.3011611326954272, 0.7568592925980462, 1.7617898565681471, 3.7450255696608448, 
              7.228293588312868, 12.737517241679422, 20.76550255554981, 31.795741097898155, 
              46.35311074058318, 65.03867098640089, 88.56109956431818, 117.75346851152344, 
              153.59550697430424, 197.24003303616564, 250.02616401142947, 313.52157881600823, 
              389.54017517386484, 592.9562737849692, 1072.9298224225863, 1997.1471729900395, 
              3643.452218124107, 6518.701518793058, 11445.5380937668, 19733.061042008874, 
              33427.2416629384, 55666.46170128159, 91184.72454373688, 146997.30100050676, 
              233336.97166118957, 364891.38569431024, 562413.4190991039, 854810.1940682632, 
              1281728.139984196, 1896842.900441679, 2771748.0126121393, 4000810.063280583])

p_500 =  np.array([1.05297098e+00, 1.18200916e+00, 1.32686056e+00, 1.48946302e+00,
 1.67199190e+00, 1.87688909e+00, 2.10689578e+00, 2.36508904e+00,
 2.65492304e+00, 2.98027527e+00, 3.34549836e+00, 3.75547836e+00,
 4.21570007e+00, 4.73232047e+00, 5.31225103e+00, 5.96325021e+00,
 6.69402722e+00, 7.51435859e+00, 8.43521892e+00, 9.46892769e+00,
 1.06293141e+01, 1.19319022e+01, 1.33941182e+01, 1.50355240e+01,
 1.68780788e+01, 1.89464328e+01, 2.12682568e+01, 2.38746128e+01,
 2.68003693e+01, 3.00846679e+01, 3.37714466e+01, 3.79100280e+01,
 4.25557793e+01, 4.77708523e+01, 5.36250156e+01, 6.01965878e+01,
 6.75734848e+01, 7.58543966e+01, 8.51501074e+01, 9.55849775e+01,
 1.07298607e+02, 1.20447704e+02, 1.35208181e+02, 1.51777505e+02,
 1.70377348e+02, 1.91256540e+02, 2.14694410e+02, 2.41004515e+02,
 2.70538839e+02, 3.03692498e+02, 3.40909030e+02, 3.82686329e+02,
 4.29583300e+02, 4.82227343e+02, 5.41322743e+02, 6.07660093e+02,
 6.82126871e+02, 7.65719312e+02, 8.59555735e+02, 9.64891509e+02,
 1.08313584e+03, 1.21587063e+03, 1.36487164e+03, 1.53213225e+03,
 1.71989009e+03, 1.93065706e+03, 2.16725283e+03, 2.43284265e+03,
 2.73097965e+03, 3.06565236e+03, 3.44133814e+03, 3.86306299e+03,
 4.33646886e+03, 4.86788908e+03, 5.46443314e+03, 6.13408173e+03,
 6.88579359e+03, 7.72962531e+03, 8.67686588e+03, 9.74018771e+03,
 1.09338162e+04, 1.22737200e+04, 1.37778246e+04, 1.54662525e+04,
 1.73615916e+04, 1.94891985e+04, 2.18775367e+04, 2.45585580e+04,
 2.75681298e+04, 3.09465149e+04, 3.47389102e+04, 3.89960512e+04,
 4.37748911e+04, 4.91393623e+04, 5.51612321e+04, 6.19210626e+04,
 6.95092884e+04, 7.80274267e+04, 8.75894354e+04, 9.83232372e+04])

tmp_500 =  [ 36.66160544,  36.85180151,  37.04398613,  37.23818163,  37.43442892,
  37.6327513,   37.83319145,  38.03577367,  38.24053923,  38.44752001,
  38.6567492,   38.86827334,  39.08212048,  39.29833923,  39.57564981,
  40.41278745,  41.77225711,  43.17745607,  44.62993492,  46.13125212,
  47.68310391,  49.28713364,  50.94515758,  52.65892742,  54.43038796,
  56.26140635,  58.15399252,  60.11028168,  62.13234863,  64.22247967,
  66.38288644,  68.61601699,  70.92422877,  73.31011262,  75.77624229,
  78.32529436,  80.96014676,  83.68359181,  86.49871111,  89.40848108,
  92.41620136,  95.52504462,  98.73846192, 102.05999914, 105.49322018,
 109.04200404, 112.71010871, 116.50168767, 120.42074667, 124.47173309,
 128.65891674, 132.98689385, 137.4605469,  142.08461949, 146.8643362,
 151.80474246, 156.91139895, 162.18958471, 167.64490686, 173.28238156,
 179.10585918, 185.11622642, 191.30628063, 197.6525812,  204.09903221,
 210.53970528, 216.81268865, 222.73578094, 228.17131147, 233.07173782,
 237.47146789, 241.44452078, 245.07236248, 248.42622081, 251.56415445,
 254.53123232, 257.36244007, 260.08525756, 262.72079077, 265.28612813,
 267.79466119, 272.78671425, 281.16213091, 290.56727642, 300.28697373,
 310.33165437, 320.71253869, 331.44050187, 342.52755405, 353.98528298,
 365.82654415, 378.0636845,  390.71014078, 403.77971582, 417.28627428,
 431.24491474, 445.67024904, 460.57843851, 475.9850524,  491.90738951]

i_lcl_373, lcl_373 = find_intersection(p_sat_373, p_vol_373, tolerance=1e0)

plt.loglog( p_vol_373, p_373, lw=1.5, ls="-", color='b', label='p_h2o')
plt.loglog( p_sat_373, p_373, lw=1.5, ls="--", color='g', label='p_sat')
plt.axhline(y=p_373[i_lcl_373], lw=1.0, ls="-", color='r')
p_vol_373[i_lcl_373:] = R_h_373[i_lcl_373:] * p_sat_373[i_lcl_373:]
plt.loglog( R_h_373 * p_sat_373, p_373, lw=1.5, ls="-", color='k', label='p_h2o_rh')
plt.gca().invert_yaxis()
plt.legend()
plt.xlabel(r'Partial pressure, $p_{h2o}$ (Pa)')
plt.ylabel(r'Pressure, $P$ (Pa)')
plt.grid(True)
plt.show()

plt.semilogy( R_h_373*100, p_373, lw=1.5, ls="-")
plt.gca().invert_yaxis()
plt.xlabel(r'Relative humidity, $R_h$ (%)')
plt.ylabel(r'Pressure, $P$ (Pa)')
plt.grid(True)
plt.xlim([0,130])
plt.savefig('test_R_h_373.pdf', bbox_inches='tight')
plt.show()

plt.semilogy( tmp_373, p_373, lw=1.5, ls="-")
plt.gca().invert_yaxis()
plt.xlabel(r'Temperature, $T$ (K)')
plt.ylabel(r'Pressure, $P$ (Pa)')
plt.grid(True)
plt.show()


i_lcl_500, lcl_500 = find_intersection(p_sat_500, p_vol_500, tolerance=1e0)

plt.loglog( p_vol_500, p_500, lw=1.5, ls="-", color='b', label='p_h2o')
plt.loglog( p_sat_500, p_500, lw=1.5, ls="--", color='g', label='p_sat')
plt.axhline(y=p_500[i_lcl_500], lw=1.0, ls="-", color='r')
p_vol_500[i_lcl_500:] = R_h_500[i_lcl_500:] * p_sat_500[i_lcl_500:]
plt.loglog( R_h_500 * p_sat_500, p_500, lw=1.5, ls="-", color='k', label='p_h2o_rh')
plt.gca().invert_yaxis()
plt.legend()
plt.xlabel(r'Partial pressure, $p_{h2o}$ (Pa)')
plt.ylabel(r'Pressure, $P$ (Pa)')
plt.grid(True)
plt.show()

plt.semilogy( R_h_500*100, p_500, lw=1.5, ls="-")
plt.gca().invert_yaxis()
plt.xlabel(r'Relative humidity, $R_h$ (%)')
plt.ylabel(r'Pressure, $P$ (Pa)')
plt.grid(True)
plt.xlim([0,130])
plt.savefig('test_R_h_500.pdf', bbox_inches='tight')
plt.show()

plt.semilogy( tmp_500, p_500, lw=1.5, ls="-")
plt.gca().invert_yaxis()
plt.xlabel(r'Temperature, $T$ (K)')
plt.ylabel(r'Pressure, $P$ (Pa)')
plt.grid(True)
plt.show()

#p_vol_500[i_lcl_500:] = R_h_373[i_lcl:] * p_sat[i_lcl:]